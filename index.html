<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>C# 2D Array: Grid Visualization Quiz</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .grid-option {
            border: 2px solid transparent;
            transition: all 0.2s ease-in-out;
            cursor: pointer;
        }
        .grid-option:hover {
            transform: scale(1.05);
            border-color: #4f46e5; /* indigo-600 */
        }
        .grid-cell {
            background-color: #e0e7ff; /* indigo-100 */
            border: 1px solid #c7d2fe; /* indigo-200 */
        }
        .dark .grid-cell {
            background-color: #3730a3; /* indigo-800 */
            border: 1px solid #4338ca; /* indigo-700 */
        }
        .correct-grid {
            border-color: #22c55e !important; /* green-500 */
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(34, 197, 94, 0.5);
        }
        .incorrect-grid {
             border-color: #ef4444 !important; /* red-500 */
             opacity: 0.6;
        }
    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 flex items-center justify-center min-h-screen p-4">

    <div id="quiz-container" class="bg-white dark:bg-gray-800 rounded-xl shadow-lg w-full max-w-2xl p-6 md:p-8">
        <h1 id="quiz-title" class="text-2xl font-bold text-gray-800 dark:text-white text-center mb-2">Grid Visualization Quiz</h1>
        <p id="quiz-subtitle" class="text-center text-gray-500 dark:text-gray-400 mb-6">Match the code to the correct grid.</p>

        <div id="question-area">
            <!-- Question will be injected here -->
        </div>

        <div id="feedback-area" class="mt-6 min-h-[50px]">
            <!-- Feedback will be injected here -->
        </div>

        <div class="mt-4 flex justify-center">
            <button id="next-btn" class="hidden bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-6 rounded-lg shadow-md transition-all">
                Next Question
            </button>
        </div>
         <div class="mt-6 text-center">
            <button id="reset-btn" class="text-sm text-gray-500 hover:text-indigo-600 dark:hover:text-indigo-400 transition-colors">
                Start New Round
            </button>
        </div>
    </div>

    <script>
        const TOTAL_QUESTIONS_PER_ROUND = 5;
        let questionsAnswered = 0;

        const questionArea = document.getElementById('question-area');
        const feedbackArea = document.getElementById('feedback-area');
        const nextBtn = document.getElementById('next-btn');
        const resetBtn = document.getElementById('reset-btn');
        const quizSubtitle = document.getElementById('quiz-subtitle');

        /**
         * Generates a random integer between min and max (inclusive).
         */
        function generateRandomInt(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }

        /**
         * Dynamically creates a unique quiz question object.
         */
        function generateQuestion() {
            const rows = generateRandomInt(2, 6);
            let cols = generateRandomInt(2, 6);

            // Ensure rows and cols are different for a better learning experience
            while (rows === cols) {
                cols = generateRandomInt(2, 6);
            }

            const correctOption = { rows, cols };
            const options = new Map(); // Use a Map to ensure unique options based on a key

            // Add the correct option
            options.set(`${correctOption.rows},${correctOption.cols}`, correctOption);

            // Add distractors until we have 3 unique options
            while (options.size < 3) {
                const distractorType = generateRandomInt(1, 3);
                let distractor;
                switch (distractorType) {
                    case 1: // Swapped dimensions
                        distractor = { rows: cols, cols: rows };
                        break;
                    case 2: // One dimension off by +1
                        distractor = { rows: rows + 1, cols: cols };
                        break;
                    case 3: // One dimension off by -1
                        distractor = { rows: rows, cols: generateRandomInt(2, 6) };
                        break;
                }
                // Add the distractor if it's valid and not a duplicate
                if (distractor.rows > 0 && distractor.cols > 0) {
                     options.set(`${distractor.rows},${distractor.cols}`, distractor);
                }
            }
            
            const finalOptions = Array.from(options.values());

            const variableNames = ["grid", "matrix", "dpTable", "board", "map", "data", "layout"];
            const variableName = variableNames[Math.floor(Math.random() * variableNames.length)];

            return {
                code: `var ${variableName} = new int[${rows}, ${cols}];`,
                correct: correctOption,
                options: finalOptions,
                explanation: `Correct! <strong>${rows} rows</strong> and <strong>${cols} columns</strong>. The first number is always rows.`
            };
        }

        function createGrid(rows, cols) {
            const gridContainer = document.createElement('div');
            gridContainer.style.display = 'grid';
            gridContainer.style.gridTemplateColumns = `repeat(${cols}, minmax(0, 1fr))`;
            gridContainer.style.gap = '4px';
            const cellSize = Math.min(24, 150 / Math.max(rows, cols));
            gridContainer.style.width = `${cols * (cellSize + 2)}px`;
            gridContainer.style.height = `${rows * (cellSize + 2)}px`;

            for (let i = 0; i < rows * cols; i++) {
                const cell = document.createElement('div');
                cell.className = 'grid-cell rounded-sm';
                gridContainer.appendChild(cell);
            }
            return gridContainer;
        }

        function loadQuestion() {
            feedbackArea.innerHTML = '';
            nextBtn.classList.add('hidden');
            questionArea.innerHTML = '';
            quizSubtitle.textContent = `Question ${questionsAnswered + 1} of ${TOTAL_QUESTIONS_PER_ROUND}`;


            if (questionsAnswered >= TOTAL_QUESTIONS_PER_ROUND) {
                showFinalScreen();
                return;
            }

            const currentQuestion = generateQuestion();

            // Code Snippet
            const codeBlock = document.createElement('div');
            codeBlock.className = "bg-gray-100 dark:bg-gray-700 rounded-md p-4 mb-6 text-center";
            const codeElement = document.createElement('code');
            codeElement.className = "text-indigo-600 dark:text-indigo-400 font-mono text-lg";
            codeElement.textContent = currentQuestion.code;
            codeBlock.appendChild(codeElement);
            questionArea.appendChild(codeBlock);

            // Grid Options
            const optionsContainer = document.createElement('div');
            optionsContainer.className = "grid grid-cols-2 md:grid-cols-3 gap-4 md:gap-6 justify-items-center items-center";
            
            const shuffledOptions = currentQuestion.options.sort(() => Math.random() - 0.5);

            shuffledOptions.forEach(option => {
                const isCorrect = option.rows === currentQuestion.correct.rows && option.cols === currentQuestion.correct.cols;
                
                const gridOptionWrapper = document.createElement('div');
                gridOptionWrapper.className = 'grid-option bg-white dark:bg-gray-700/50 p-3 rounded-lg shadow-sm flex flex-col items-center gap-2';
                gridOptionWrapper.onclick = () => handleAnswer(isCorrect, currentQuestion.explanation);
                
                const gridElement = createGrid(option.rows, option.cols);
                const dimensionsText = document.createElement('p');
                dimensionsText.className = "text-xs text-gray-500 dark:text-gray-400 font-mono";
                dimensionsText.textContent = `${option.rows} rows, ${option.cols} cols`;

                gridOptionWrapper.appendChild(gridElement);
                gridOptionWrapper.appendChild(dimensionsText);
                
                gridOptionWrapper.dataset.isCorrect = isCorrect;
                optionsContainer.appendChild(gridOptionWrapper);
            });
            questionArea.appendChild(optionsContainer);
        }

        function handleAnswer(isCorrect, explanation) {
            document.querySelectorAll('.grid-option').forEach(el => {
                el.onclick = null; // Disable further clicks
                if (el.dataset.isCorrect === 'true') {
                    el.classList.add('correct-grid');
                } else {
                    el.classList.add('incorrect-grid');
                }
            });

            feedbackArea.innerHTML = '';
            const feedbackDiv = document.createElement('div');
            feedbackDiv.className = `p-3 rounded-lg text-center ${isCorrect ? 'bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200' : 'bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200'}`;
            feedbackDiv.innerHTML = `<p class="font-semibold">${isCorrect ? 'Correct!' : 'Not quite.'}</p><p>${explanation}</p>`;
            feedbackArea.appendChild(feedbackDiv);
            
            questionsAnswered++;
            nextBtn.classList.remove('hidden');
            if (questionsAnswered >= TOTAL_QUESTIONS_PER_ROUND) {
                nextBtn.textContent = "See Results";
            }
        }

        function showFinalScreen() {
            questionArea.innerHTML = `
                <div class="text-center">
                    <h2 class="text-2xl font-bold text-gray-800 dark:text-white">Round Complete!</h2>
                    <p class="mt-2 text-gray-600 dark:text-gray-300">You've mastered visualizing 2D arrays. The key is always:</p>
                    <div class="bg-indigo-100 dark:bg-indigo-900 text-indigo-800 dark:text-indigo-200 rounded-lg p-4 my-4 font-mono text-xl">
                        new Type[<strong class="text-red-500">rows</strong>, <strong class="text-blue-500">columns</strong>]
                    </div>
                    <p class="mt-4 text-gray-500 dark:text-gray-400">Click "Start New Round" to practice more!</p>
                </div>
            `;
            nextBtn.classList.add('hidden');
            quizSubtitle.textContent = "Practice makes perfect!";
        }

        function startNewRound() {
            questionsAnswered = 0;
            nextBtn.textContent = "Next Question";
            loadQuestion();
        }

        nextBtn.addEventListener('click', loadQuestion);
        resetBtn.addEventListener('click', startNewRound);

        window.onload = startNewRound;
    </script>
</body>
</html>
